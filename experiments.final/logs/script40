+ export CUDA_VISIBLE_DEVICES=1
+ CUDA_VISIBLE_DEVICES=1
+ LAYERS='300_300_300_1 500_500_500_500_1'
+ LAYERS=500_500_500_500_1
++ pwd
+ OUT=/home/mrdouglas/Manifold/experiments.final/output40
+ for psi in -2 -1
+ for phi in 0 0.4 0.8 1.2 1.6 2 2.4 2.8 3
+ OUTDIR=/home/mrdouglas/Manifold/experiments.final/output40/f1_psi-2_phi0
+ mkdir -p /home/mrdouglas/Manifold/experiments.final/output40/f1_psi-2_phi0
+ for layers in $LAYERS
+ python biholoNN_train.py --seed 1234 --n_pairs 4000 --batch_size 5000 --load_model experiments.yidi/biholo/f0_psi0.5/500_500_500_500_1 --optimizer lbfgs --function f1 --psi -2 --phi 0 --layers 500_500_500_500_1 --save_dir /home/mrdouglas/Manifold/experiments.final/output40/f1_psi-2_phi0/ --save_name 500_500_500_500_1 --max_epochs 2000 --loss_func weighted_MSE
Processing model: 500_500_500_500_1
WARNING:tensorflow:5 out of the last 5 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c2e0bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:6 out of the last 6 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c2009d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:7 out of the last 7 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c2007b8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:8 out of the last 8 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c2e08c8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:9 out of the last 9 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c245598> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:10 out of the last 10 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c244ea0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c166bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c166ae8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c1a02f0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c13d598> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c1a0b70> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c166d90> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c11d7b8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c11d8c8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c07f0d0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c07f510> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa04c07f400> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa029be6620> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa029bbac80> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa029bba2f0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa029bbad90> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa029b398c8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa029afb8c8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa029b00950> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa029b008c8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa0043af7b8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa004348840> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa0043af840> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa00430b400> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa00430b950> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa0042d6c80> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa0042a49d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa0042a4a60> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa004240ae8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa00422d840> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:11 out of the last 11 calls to <function Hypersurface.num_FS_volume_form_tf at 0x7fa00422a510> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
Iter: 1 loss: 0.00381049141
Iter: 2 loss: 0.00367320445
Iter: 3 loss: 0.00397236971
Iter: 4 loss: 0.00361656258
Iter: 5 loss: 0.00354027702
Iter: 6 loss: 0.00413074205
Iter: 7 loss: 0.00353469653
Iter: 8 loss: 0.00341797783
Iter: 9 loss: 0.00304623041
Iter: 10 loss: 0.00326687982
Iter: 11 loss: 0.00274156034
Iter: 12 loss: 0.00305848
Iter: 13 loss: 0.00260984572
Iter: 14 loss: 0.00250080787
Iter: 15 loss: 0.00245969393
Iter: 16 loss: 0.00240071863
Iter: 17 loss: 0.00230089622
Iter: 18 loss: 0.00226243329
Iter: 19 loss: 0.00221232953
Iter: 20 loss: 0.00220224401
Iter: 21 loss: 0.00217445
Iter: 22 loss: 0.0021469777
Iter: 23 loss: 0.00221502921
Iter: 24 loss: 0.00213745888
Iter: 25 loss: 0.00211514346
Iter: 26 loss: 0.00211804872
Iter: 27 loss: 0.00209807628
Iter: 28 loss: 0.00207103323
Iter: 29 loss: 0.00207092054
Iter: 30 loss: 0.00204089424
Iter: 31 loss: 0.00215774635
Iter: 32 loss: 0.00203382201
Iter: 33 loss: 0.00200469326
Iter: 34 loss: 0.00193472579
Iter: 35 loss: 0.00256502628
Iter: 36 loss: 0.00192706659
Iter: 37 loss: 0.00183487718
Iter: 38 loss: 0.00215697847
Iter: 39 loss: 0.00181243487
Iter: 40 loss: 0.00174783322
Iter: 41 loss: 0.00173939567
Iter: 42 loss: 0.0016937342
Iter: 43 loss: 0.00160489511
Iter: 44 loss: 0.00166462385
Iter: 45 loss: 0.00155093067
Iter: 46 loss: 0.00144715956
Iter: 47 loss: 0.00185778295
Iter: 48 loss: 0.00141097116
Iter: 49 loss: 0.00129277934
Iter: 50 loss: 0.00224801851
Iter: 51 loss: 0.00128734927
Iter: 52 loss: 0.00123702572
Iter: 53 loss: 0.00123700022
Iter: 54 loss: 0.00118280714
Iter: 55 loss: 0.00135151809
Iter: 56 loss: 0.00116846198
Iter: 57 loss: 0.00113110244
Iter: 58 loss: 0.00122566451
Iter: 59 loss: 0.00111801713
Iter: 60 loss: 0.00109835807
Iter: 61 loss: 0.00110748666
Iter: 62 loss: 0.00108549302
Iter: 63 loss: 0.00106471474
Iter: 64 loss: 0.00109708984
Iter: 65 loss: 0.00105400197
Iter: 66 loss: 0.00103962491
Iter: 67 loss: 0.00103752431
Iter: 68 loss: 0.00101493602
Iter: 69 loss: 0.00139514031
Iter: 70 loss: 0.00101489737
Iter: 71 loss: 0.000991161447
Iter: 72 loss: 0.0010155316
Iter: 73 loss: 0.000977694523
Iter: 74 loss: 0.000940002268
Iter: 75 loss: 0.000929475762
Iter: 76 loss: 0.000905344146
Iter: 77 loss: 0.000838694046
Iter: 78 loss: 0.00157402654
Iter: 79 loss: 0.000837176922
Iter: 80 loss: 0.000792427454
Iter: 81 loss: 0.000800774549
Iter: 82 loss: 0.000757788599
Iter: 83 loss: 0.000718228112
Iter: 84 loss: 0.00123833236
Iter: 85 loss: 0.000717388
Iter: 86 loss: 0.000683467835
Iter: 87 loss: 0.000672074617
Iter: 88 loss: 0.000643413048
Iter: 89 loss: 0.000676127675
Iter: 90 loss: 0.00062766613
Iter: 91 loss: 0.000610295101
Iter: 92 loss: 0.000609012437
Iter: 93 loss: 0.000597135571
Iter: 94 loss: 0.000630497932
Iter: 95 loss: 0.000593132
Iter: 96 loss: 0.00057525537
Iter: 97 loss: 0.000579617103
Iter: 98 loss: 0.000561835419
Iter: 99 loss: 0.000530936639
Iter: 100 loss: 0.000592949393
Iter: 101 loss: 0.000517419307
Iter: 102 loss: 0.000488180056
Iter: 103 loss: 0.000910385745
Iter: 104 loss: 0.00048770482
Iter: 105 loss: 0.000460183714
Iter: 106 loss: 0.000660303573
Iter: 107 loss: 0.000456897717
Iter: 108 loss: 0.000434537156
Iter: 109 loss: 0.000434168149
Iter: 110 loss: 0.000408636144
Iter: 111 loss: 0.000588390394
Iter: 112 loss: 0.000405786384
Iter: 113 loss: 0.000391229463
Iter: 114 loss: 0.000381921302
Iter: 115 loss: 0.000376160606
Iter: 116 loss: 0.000357239391
Iter: 117 loss: 0.000500170398
Iter: 118 loss: 0.00035545358
Iter: 119 loss: 0.000343152467
Iter: 120 loss: 0.000343151856
Iter: 121 loss: 0.000333651376
Iter: 122 loss: 0.000371287519
Iter: 123 loss: 0.00033146824
Iter: 124 loss: 0.000316939666
Iter: 125 loss: 0.000354372023
Iter: 126 loss: 0.000311668
Iter: 127 loss: 0.000298329396
Iter: 128 loss: 0.000297866238
Iter: 129 loss: 0.000283392059
Iter: 130 loss: 0.000349099282
Iter: 131 loss: 0.000280242326
Iter: 132 loss: 0.00027159712
Iter: 133 loss: 0.000283406291
Iter: 134 loss: 0.000267162803
Iter: 135 loss: 0.00025657349
Iter: 136 loss: 0.000256570434
Iter: 137 loss: 0.000247731747
Iter: 138 loss: 0.000285776099
Iter: 139 loss: 0.000245919131
Iter: 140 loss: 0.000239261586
Iter: 141 loss: 0.000271920231
Iter: 142 loss: 0.00023812562
Iter: 143 loss: 0.000232856793
Iter: 144 loss: 0.000245608157
Iter: 145 loss: 0.000230990845
Iter: 146 loss: 0.00022616738
Iter: 147 loss: 0.000237084183
Iter: 148 loss: 0.00022436335
Iter: 149 loss: 0.000220321788
Iter: 150 loss: 0.000230928432
Iter: 151 loss: 0.00021895126
Iter: 152 loss: 0.000213536608
Iter: 153 loss: 0.000253083184
Iter: 154 loss: 0.000213070103
Iter: 155 loss: 0.000208840822
Iter: 156 loss: 0.000212410858
Iter: 157 loss: 0.000206315191
Iter: 158 loss: 0.00020234687
Iter: 159 loss: 0.000204068594
Iter: 160 loss: 0.000199642731
Iter: 161 loss: 0.00019484169
Iter: 162 loss: 0.000203178468
Iter: 163 loss: 0.000192723062
Iter: 164 loss: 0.000187647296
Iter: 165 loss: 0.000182472199
Iter: 166 loss: 0.000181461801
Iter: 167 loss: 0.000176854199
Iter: 168 loss: 0.000176848698
Iter: 169 loss: 0.000173182765
Iter: 170 loss: 0.000200460374
Iter: 171 loss: 0.000172881395
Iter: 172 loss: 0.000170272964
Iter: 173 loss: 0.000169179417
Iter: 174 loss: 0.000167809136
Iter: 175 loss: 0.000164280325
Iter: 176 loss: 0.000175749956
Iter: 177 loss: 0.000163291814
Iter: 178 loss: 0.000160512645
Iter: 179 loss: 0.000182033065
Iter: 180 loss: 0.000160311858
Iter: 181 loss: 0.000157896851
Iter: 182 loss: 0.000161502
Iter: 183 loss: 0.000156729424
Iter: 184 loss: 0.000153963163
Iter: 185 loss: 0.000150549895
Iter: 186 loss: 0.00015024496
Iter: 187 loss: 0.00014532468
Iter: 188 loss: 0.00022352417
Iter: 189 loss: 0.000145324433
Iter: 190 loss: 0.000142503515
Iter: 191 loss: 0.000155555492
Iter: 192 loss: 0.000141956916
Iter: 193 loss: 0.000138973934
Iter: 194 loss: 0.000163321442
Iter: 195 loss: 0.00013878633
Iter: 196 loss: 0.000136105
Iter: 197 loss: 0.000134963382
Iter: 198 loss: 0.000133582958
Iter: 199 loss: 0.000131071036
Iter: 200 loss: 0.000146190228
Iter: 201 loss: 0.000130755943
Iter: 202 loss: 0.000128364161
Iter: 203 loss: 0.00014825289
Iter: 204 loss: 0.000128216678
Iter: 205 loss: 0.000126336919
Iter: 206 loss: 0.000127328894
Iter: 207 loss: 0.000125097271
Iter: 208 loss: 0.000122965517
Iter: 209 loss: 0.000134920949
Iter: 210 loss: 0.000122662386
Iter: 211 loss: 0.000121226782
Iter: 212 loss: 0.000126563624
Iter: 213 loss: 0.000120870463
Iter: 214 loss: 0.00011929516
Iter: 215 loss: 0.000123984224
Iter: 216 loss: 0.000118814678
Iter: 217 loss: 0.000116826683
Iter: 218 loss: 0.00011912646
Iter: 219 loss: 0.000115763782
Iter: 220 loss: 0.000114012102
Iter: 221 loss: 0.000125634688
Iter: 222 loss: 0.000113831331
Iter: 223 loss: 0.000112349109
Iter: 224 loss: 0.000130127635
Iter: 225 loss: 0.000112326605
Iter: 226 loss: 0.000111367321
Iter: 227 loss: 0.000111057525
Iter: 228 loss: 0.000110498928
Iter: 229 loss: 0.000108385677
Iter: 230 loss: 0.000109418361
Iter: 231 loss: 0.000106962296
Iter: 232 loss: 0.000104904917
Iter: 233 loss: 0.000107809232
Iter: 234 loss: 0.000103878228
Iter: 235 loss: 0.000102379679
Iter: 236 loss: 0.000107182568
Iter: 237 loss: 0.000101952042
Iter: 238 loss: 0.000101399535
Iter: 239 loss: 0.000101149955
Iter: 240 loss: 0.000100621335
Iter: 241 loss: 0.000100341116
Iter: 242 loss: 0.000100098376
Iter: 243 loss: 9.87228559e-05
Iter: 244 loss: 9.91072e-05
Iter: 245 loss: 9.77283635e-05
Iter: 246 loss: 9.66693187e-05
Iter: 247 loss: 0.000111297486
Iter: 248 loss: 9.66655352e-05
Iter: 249 loss: 9.5802985e-05
Iter: 250 loss: 9.85583e-05
Iter: 251 loss: 9.55476426e-05
Iter: 252 loss: 9.40741302e-05
Iter: 253 loss: 9.26963839e-05
Iter: 254 loss: 9.23494881e-05
Iter: 255 loss: 9.04717817e-05
Iter: 256 loss: 9.0394984e-05
Iter: 257 loss: 8.89808871e-05
Iter: 258 loss: 9.69210232e-05
Iter: 259 loss: 8.87704664e-05
Iter: 260 loss: 8.78291758e-05
Iter: 261 loss: 9.08439397e-05
Iter: 262 loss: 8.75626793e-05
Iter: 263 loss: 8.64791364e-05
Iter: 264 loss: 8.68315e-05
Iter: 265 loss: 8.57114283e-05
Iter: 266 loss: 8.46336043e-05
Iter: 267 loss: 8.85045447e-05
Iter: 268 loss: 8.43517919e-05
Iter: 269 loss: 8.35840256e-05
Iter: 270 loss: 8.44089082e-05
Iter: 271 loss: 8.3163337e-05
Iter: 272 loss: 8.19571869e-05
Iter: 273 loss: 8.82646636e-05
Iter: 274 loss: 8.17681e-05
Iter: 275 loss: 8.07549295e-05
Iter: 276 loss: 8.28682678e-05
Iter: 277 loss: 8.03438743e-05
Iter: 278 loss: 7.94569642e-05
Iter: 279 loss: 7.99486e-05
Iter: 280 loss: 7.88782199e-05
Iter: 281 loss: 7.74089567e-05
Iter: 282 loss: 8.62824527e-05
Iter: 283 loss: 7.72278509e-05
Iter: 284 loss: 7.59084069e-05
Iter: 285 loss: 8.81907763e-05
Iter: 286 loss: 7.58514216e-05
Iter: 287 loss: 7.53251152e-05
Iter: 288 loss: 7.40803298e-05
Iter: 289 loss: 8.86280613e-05
Iter: 290 loss: 7.3968331e-05
Iter: 291 loss: 7.32492917e-05
Iter: 292 loss: 7.31991313e-05
Iter: 293 loss: 7.24755737e-05
Iter: 294 loss: 7.56481313e-05
Iter: 295 loss: 7.23288467e-05
Iter: 296 loss: 7.17812072e-05
Iter: 297 loss: 7.14633206e-05
Iter: 298 loss: 7.12310284e-05
Iter: 299 loss: 7.04277118e-05
Iter: 300 loss: 7.97526882e-05
Iter: 301 loss: 7.04153936e-05
Iter: 302 loss: 6.98420772e-05
Iter: 303 loss: 7.26184153e-05
Iter: 304 loss: 6.97414362e-05
Iter: 305 loss: 6.91826208e-05
Iter: 306 loss: 6.87051943e-05
Iter: 307 loss: 6.85524865e-05
Iter: 308 loss: 6.77155476e-05
Iter: 309 loss: 6.88468e-05
Iter: 310 loss: 6.72943352e-05
Iter: 311 loss: 6.64226172e-05
Iter: 312 loss: 6.64225372e-05
Iter: 313 loss: 6.58540957e-05
Iter: 314 loss: 6.48041532e-05
Iter: 315 loss: 8.85385307e-05
Iter: 316 loss: 6.48023852e-05
Iter: 317 loss: 6.4595748e-05
Iter: 318 loss: 6.42662271e-05
Iter: 319 loss: 6.39593e-05
Iter: 320 loss: 6.31407529e-05
Iter: 321 loss: 6.91062523e-05
Iter: 322 loss: 6.29603746e-05
Iter: 323 loss: 6.20047649e-05
Iter: 324 loss: 6.38341e-05
Iter: 325 loss: 6.16031466e-05
Iter: 326 loss: 6.09865092e-05
Iter: 327 loss: 6.63052488e-05
Iter: 328 loss: 6.09533818e-05
Iter: 329 loss: 6.03102344e-05
Iter: 330 loss: 5.98036058e-05
Iter: 331 loss: 5.96020363e-05
Iter: 332 loss: 5.8664169e-05
Iter: 333 loss: 6.05870919e-05
Iter: 334 loss: 5.82843604e-05
Iter: 335 loss: 5.81473978e-05
Iter: 336 loss: 5.79185653e-05
Iter: 337 loss: 5.75186e-05
Iter: 338 loss: 5.69603326e-05
Iter: 339 loss: 5.69371296e-05
Iter: 340 loss: 5.6237026e-05
Iter: 341 loss: 5.93996265e-05
Iter: 342 loss: 5.61001325e-05
Iter: 343 loss: 5.57894782e-05
Iter: 344 loss: 5.5696004e-05
Iter: 345 loss: 5.52491183e-05
Iter: 346 loss: 5.4334887e-05
Iter: 347 loss: 7.18148804e-05
Iter: 348 loss: 5.43197639e-05
Iter: 349 loss: 5.34517276e-05
Iter: 350 loss: 5.65923656e-05
Iter: 351 loss: 5.32367194e-05
Iter: 352 loss: 5.26152799e-05
Iter: 353 loss: 5.26023941e-05
Iter: 354 loss: 5.22674345e-05
Iter: 355 loss: 5.17709559e-05
Iter: 356 loss: 5.17579247e-05
Iter: 357 loss: 5.13615378e-05
Iter: 358 loss: 5.13457344e-05
Iter: 359 loss: 5.09722959e-05
Iter: 360 loss: 5.28341261e-05
Iter: 361 loss: 5.09098536e-05
Iter: 362 loss: 5.05581847e-05
Iter: 363 loss: 5.01678369e-05
Iter: 364 loss: 5.01108e-05
Iter: 365 loss: 4.96099747e-05
Iter: 366 loss: 5.25472133e-05
Iter: 367 loss: 4.95445711e-05
Iter: 368 loss: 4.91094252e-05
Iter: 369 loss: 4.91050232e-05
Iter: 370 loss: 4.88212754e-05
Iter: 371 loss: 4.83241893e-05
Iter: 372 loss: 4.8324051e-05
Iter: 373 loss: 4.72832835e-05
Iter: 374 loss: 5.10831378e-05
Iter: 375 loss: 4.7024274e-05
Iter: 376 loss: 4.62844946e-05
Iter: 377 loss: 4.7790214e-05
Iter: 378 loss: 4.59807125e-05
Iter: 379 loss: 4.63063043e-05
Iter: 380 loss: 4.57187089e-05
Iter: 381 loss: 4.5505476e-05
Iter: 382 loss: 4.54054389e-05
Iter: 383 loss: 4.53037792e-05
Iter: 384 loss: 4.4744058e-05
Iter: 385 loss: 4.54046785e-05
Iter: 386 loss: 4.44481411e-05
Iter: 387 loss: 4.38479838e-05
Iter: 388 loss: 4.98535628e-05
Iter: 389 loss: 4.38288698e-05
Iter: 390 loss: 4.34298418e-05
Iter: 391 loss: 4.35925358e-05
Iter: 392 loss: 4.31558256e-05
Iter: 393 loss: 4.2792537e-05
Iter: 394 loss: 4.31613444e-05
Iter: 395 loss: 4.25879844e-05
Iter: 396 loss: 4.23727543e-05
Iter: 397 loss: 4.23154124e-05
Iter: 398 loss: 4.20240322e-05
Iter: 399 loss: 4.23928723e-05
Iter: 400 loss: 4.18750278e-05
Iter: 401 loss: 4.15039794e-05
Iter: 402 loss: 4.26124025e-05
Iter: 403 loss: 4.13896305e-05
Iter: 404 loss: 4.09497661e-05
Iter: 405 loss: 4.54086039e-05
Iter: 406 loss: 4.09360582e-05
Iter: 407 loss: 4.06263061e-05
Iter: 408 loss: 4.06546824e-05
Iter: 409 loss: 4.03863305e-05
Iter: 410 loss: 3.99596429e-05
Iter: 411 loss: 4.22701778e-05
Iter: 412 loss: 3.9888484e-05
Iter: 413 loss: 3.95045245e-05
Iter: 414 loss: 4.14042588e-05
Iter: 415 loss: 3.94387862e-05
Iter: 416 loss: 3.91645517e-05
Iter: 417 loss: 3.90403657e-05
Iter: 418 loss: 3.89040724e-05
Iter: 419 loss: 3.84903033e-05
Iter: 420 loss: 3.9821236e-05
Iter: 421 loss: 3.83655934e-05
Iter: 422 loss: 3.79422054e-05
Iter: 423 loss: 3.79419507e-05
Iter: 424 loss: 3.7742273e-05
Iter: 425 loss: 3.78120531e-05
Iter: 426 loss: 3.76023891e-05
Iter: 427 loss: 3.73326257e-05
Iter: 428 loss: 3.78998e-05
Iter: 429 loss: 3.72239083e-05
Iter: 430 loss: 3.69056434e-05
Iter: 431 loss: 3.80988386e-05
Iter: 432 loss: 3.6828671e-05
Iter: 433 loss: 3.65071755e-05
Iter: 434 loss: 3.69824629e-05
Iter: 435 loss: 3.63552681e-05
Iter: 436 loss: 3.60891936e-05
Iter: 437 loss: 3.60891499e-05
Iter: 438 loss: 3.58238904e-05
Iter: 439 loss: 3.65058222e-05
Iter: 440 loss: 3.57321514e-05
Iter: 441 loss: 3.54837903e-05
Iter: 442 loss: 3.52588868e-05
Iter: 443 loss: 3.5196892e-05
Iter: 444 loss: 3.48509566e-05
Iter: 445 loss: 3.57424069e-05
Iter: 446 loss: 3.4725279e-05
Iter: 447 loss: 3.44581968e-05
Iter: 448 loss: 3.78671975e-05
Iter: 449 loss: 3.44562286e-05
Iter: 450 loss: 3.42656494e-05
Iter: 451 loss: 3.42872299e-05
Iter: 452 loss: 3.41190753e-05
Iter: 453 loss: 3.39205399e-05
Iter: 454 loss: 3.5072484e-05
Iter: 455 loss: 3.38891696e-05
Iter: 456 loss: 3.36394405e-05
Iter: 457 loss: 3.44518121e-05
Iter: 458 loss: 3.35691366e-05
Iter: 459 loss: 3.32864947e-05
Iter: 460 loss: 3.34924844e-05
Iter: 461 loss: 3.31128031e-05
Iter: 462 loss: 3.2769145e-05
Iter: 463 loss: 3.27794151e-05
Iter: 464 loss: 3.24937137e-05
Iter: 465 loss: 3.20929394e-05
Iter: 466 loss: 3.26270274e-05
Iter: 467 loss: 3.18916609e-05
Iter: 468 loss: 3.18779094e-05
Iter: 469 loss: 3.16983715e-05
Iter: 470 loss: 3.15468642e-05
Iter: 471 loss: 3.13680066e-05
Iter: 472 loss: 3.13476812e-05
Iter: 473 loss: 3.10712749e-05
Iter: 474 loss: 3.21014668e-05
Iter: 475 loss: 3.1010095e-05
Iter: 476 loss: 3.0804651e-05
Iter: 477 loss: 3.13318415e-05
Iter: 478 loss: 3.07337214e-05
Iter: 479 loss: 3.0434876e-05
Iter: 480 loss: 3.2430522e-05
Iter: 481 loss: 3.04046771e-05
Iter: 482 loss: 3.02216977e-05
Iter: 483 loss: 3.0096915e-05
Iter: 484 loss: 3.00299671e-05
Iter: 485 loss: 2.98311697e-05
Iter: 486 loss: 3.26738154e-05
Iter: 487 loss: 2.98305913e-05
Iter: 488 loss: 2.96698927e-05
Iter: 489 loss: 2.97306433e-05
Iter: 490 loss: 2.95573918e-05
Iter: 491 loss: 2.93699431e-05
Iter: 492 loss: 2.9547602e-05
Iter: 493 loss: 2.92627756e-05
Iter: 494 loss: 2.92236291e-05
Iter: 495 loss: 2.91682445e-05
Iter: 496 loss: 2.90780608e-05
Iter: 497 loss: 2.88691645e-05
Iter: 498 loss: 3.2071508e-05
Iter: 499 loss: 2.88555675e-05
Iter: 500 loss: 2.86953909e-05
Iter: 501 loss: 2.86693648e-05
Iter: 502 loss: 2.8462473e-05
Iter: 503 loss: 3.02538883e-05
Iter: 504 loss: 2.84519774e-05
Iter: 505 loss: 2.83425143e-05
Iter: 506 loss: 2.81089033e-05
Iter: 507 loss: 3.18962557e-05
Iter: 508 loss: 2.810144e-05
Iter: 509 loss: 2.78138286e-05
Iter: 510 loss: 2.90184762e-05
Iter: 511 loss: 2.77535109e-05
Iter: 512 loss: 2.75990569e-05
Iter: 513 loss: 2.96166836e-05
